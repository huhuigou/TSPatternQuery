<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Tutorial and User Evaluation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TSPatternQuery</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="evaluation.html">Tutorial/User Evaluation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Tutorial and User Evaluation</h1>

</div>


<p>This page contains several exercises that may be used as a tutorial for the TSPatternQuery package. Should you wish to help by providing feedback, you may also participate in the user evaluation. Instructions for doing so are included in the next section.</p>
<div id="evaluation-preamble" class="section level1">
<h1>Evaluation Preamble</h1>
<p>The aim of this evaluation is to gain feedback on the TSPatternQuery package. It is important to involve users in the design of software packages so to ensure that software developed not only solves the problem, but is also usable. This evaluation is set up so that you may do it on your own. Simply follow the instructions given in this document and answer the questionnaire at the end. The exercises below will require you to download a package in RStudio and use it on time series data that will be provided. At the end of the exercises, you will be instructed to save and send me the contents of an .Rhistory file containing everything that you typed into the R console during this session. The only other data collected during this evaluation will be your answers to the questionnaire. If you have any questions, feel free to contact me via email at joshanthonymarsh (AT) gmail (DOT) com. The purpose of this evaluation is not to test your ability. Should you find a particular task difficult, please indicate so in the questionnaire (or by emailing me). This is likely an indicator that something is deficient in the software or its documentation, and is useful feedback. You are welcome to withdraw from the experiment at any time. <strong>At this point, please send me an email at joshanthonymarsh (AT) gmail (DOT) com stating that you agree to take part in this evaluation.</strong> An email including your name and the sentence “I agree to take part in the TSPatternQuery evaluation.” will suffice. I also encourage you to include any questions that you may have in this email. If you do include questions in your email, please wait for me to get back to you before you begin the evaluation.</p>
<p><strong>Please note</strong> that I have avoid describing the TSPatternQuery tool in this evaluation page. Part of what is being evaluated is the documentation for the package. Please click the “Home” button at the top of this page to view the vignette for this package. You are encouraged to read as much of the vignette as you feel is necessary to understand and work with the TSPatternQuery package.</p>
</div>
<div id="part-1-setup" class="section level1">
<h1>Part 1: Setup</h1>
<p>It is recommended that you use RStudio for the following exercises. If you do not already have RStudio installed, then you may download it from this link: <a href="https://www.rstudio.com/">Download RStudio</a>. Alternatively, you may launch RStudio in a web browser using <a href="https://www.rollapp.com/app/rstudio">rollApp RStudio</a>. The second option may result in slower package download and execution times.</p>
<p>Open a new session in RStudio. Please note that if you are taking part in the evaluation, you will be saving your R console session history to a new “evaluation.Rhistory” file at the end of these exercises.</p>
<p>Enter the following commands into the R console to install the TSPatternQuery package.</p>
<pre class="r"><code>devtools::install_github(&quot;joshmarsh/TSPatternQuery&quot;)
library(TSPatternQuery)
library(xts)</code></pre>
<p>You may optionally add the <code>build_vignettes=TRUE</code> parameter to <code>devtools::install_github(&quot;joshmarsh/TSPatternQuery&quot;)</code>, however the vignette for TSPatternQuery may be more easily viewed by clicking the Home button at the top of this screen. You do not need to read the vignette in it’s entirety. It is there for you to reference if you get stuck at any point.</p>
</div>
<div id="part-2-pattern-template-and-matching-threshold" class="section level1">
<h1>Part 2: Pattern Template and Matching Threshold</h1>
<p>Copy-paste the following command into the R console to import a time series for this exercise.</p>
<pre class="r"><code>ts.path.p2 &lt;- system.file(&quot;extdata&quot;, &quot;part2_ts.csv&quot;, package = &quot;TSPatternQuery&quot;)
part2.ts &lt;- xts(read.csv(ts.path.p2)[[2]], 
              order.by = as.POSIXct(read.csv(ts.path.p2)[[1]]))</code></pre>
<p>Using the <code>CreateCustomTimeSeries</code> function, please define a pattern template in order to find the following pattern. You may name it <code>part2.pattern</code>. Notice that the points of the pattern are spaced in 5 second intervals.</p>
<p><img src="evaluation_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Once you have defined the pattern, use the <code>Query</code> function to find occurrences of the pattern in the timesiers that you imported. You may at first use the <em>timeseries</em> and <strong>pattern.template</strong> only. You will likely notice that the Query functions finds multiple matches. If you do not show any matches, there may be a problem with your pattern template.</p>
<p>Set the <strong>return.matched.patterns</strong> parameter to TRUE in order to return a list of the windows that have been matched. Plot these so that you can see how successful your query has been.</p>
<p>Next, try incrasing the <strong>spearmans.rho.threshold</strong> until you are satisfied that your query isn’t too permissive. You may then move on to the next section.</p>
</div>
<div id="part-3-window-length" class="section level1">
<h1>Part 3: Window Length</h1>
<p>Copy-paste the following command into the R console to import a time series for this exercise.</p>
<pre class="r"><code>ts.path.p3 &lt;- system.file(&quot;extdata&quot;, &quot;part3_ts.csv&quot;, package = &quot;TSPatternQuery&quot;)
part3.ts &lt;- xts(read.csv(ts.path.p3)[[2]], 
              order.by = as.POSIXct(read.csv(ts.path.p3)[[1]]))</code></pre>
<p>Run the following command in the R console to create a pattern template. This pattern is the same shape as the one that you used in part 2, however it is being provided to you this time to ensure that it is correct.</p>
<pre class="r"><code>part3.pattern &lt;- CreateCustomTimeSeries(
  values = c(0, -1, 2, -4, 2, -1, 0),
  intervals = c(5,5,5,5,5,5)
)</code></pre>
<p>Go ahead and run the Query function with the pattern template and time series. It should not find any matches. This is because the length of the sliding window is incorrect. It has been set to 30 seconds in the code (The vector <code>c(5,5,5,5,5,5)</code> has a total length of 30) Assume that you have prior knowledge, which allows you to estimate that the length of the pattern should be somewhere between 5 and 9 days.</p>
<p>Try rerunning the Query function with an adjusted <strong>window.length</strong> based on your prior knowledge. Try different lengths until you find a match. If you you are unable to find a match after several tries, refer to the documentation over <strong>window.length</strong> to ensure that you are passing it correct values.</p>
</div>
<div id="part-4-distinctive-feature" class="section level1">
<h1>Part 4: Distinctive Feature</h1>
<p>Copy-paste the following command into the R console to import a time series for this exercise.</p>
<pre class="r"><code>ts.path.p4 &lt;- system.file(&quot;extdata&quot;, &quot;part4_ts.csv&quot;, package = &quot;TSPatternQuery&quot;)
part4.ts &lt;- xts(read.csv(ts.path.p4)[[2]], 
              order.by = as.POSIXct(read.csv(ts.path.p4)[[1]]))</code></pre>
<p>Run the following command in the R console to create a pattern template.</p>
<pre class="r"><code>part4.pattern &lt;- CreateCustomTimeSeries(
  values = c(0,-4,-3,-8,-3,-4,0),
  intervals = c(5,5,5,5,5,5)
)</code></pre>
<p>An appropriate <strong>window.length</strong> for this pattern is 5 days. Assume that you have prior knowledge that the normal range of values for this time series is between 85 and 100. A marked feature of the pattern you are searching for is that the central peak drops below this range (i.e. the central peak drops below 85).</p>
<p>Using this information, try to implement a <strong>distinctive.feature</strong> that will decrease the running time of this query. You may use the <code>system.time()</code> function to record the elapsed time of the function like so:</p>
<pre class="r"><code>time.without.df &lt;- system.time(
  Query(
    part4.ts,
    part4.pattern,
    window.length = 60*60*24*5
  )
)
cat(&quot;Elapsed Time: &quot;, time.without.df[[3]])</code></pre>
<pre><code>## Elapsed Time:  0.522</code></pre>
</div>
<div id="part-5-ruleset" class="section level1">
<h1>Part 5: Ruleset</h1>
<p>This exercise will use a list of 10 time series. Copy-paste the following command into the R console to import the list.</p>
<pre class="r"><code>part5.ts.list &lt;- list()
for( i in 1:10 ){
  path &lt;- system.file(&quot;extdata&quot;, paste(&quot;part5_ts_&quot;, i, &quot;.csv&quot;, sep = &quot;&quot;), package = &quot;TSPatternQuery&quot;)
  part5.ts.list[[i]] &lt;- xts(read.csv(path)[[2]], order.by = as.POSIXct(read.csv(path)[[1]]))
}</code></pre>
<p>Run this command to define the pattern that you will be using.</p>
<pre class="r"><code>part5.pattern &lt;- CreateCustomTimeSeries(
  values = c(0, 10, 5, 15, 5, 10, 0),
  intervals = c(5,5,5,5,5,5)
)
plot(part5.pattern)</code></pre>
<p><img src="evaluation_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>part5.ts.list contains a list of time series with embedded patterns that have successively larger middle peaks. part5.ts.list[[1]] contains peak heights 4, 4, 4. part5.ts.list[[2]] has peak heights 4, 5, 4. part5.ts.list[[3]] has peak heights 4, 6, 4, and so on up to part5.ts.list[[10]].</p>
<p>You may use the for loop provided below to plot each of the time series in the list. Notice that the pattern as been embedded in the centre of each (i.e. indexes 51 to 57).</p>
<pre class="r"><code>for(i in 1:length(part5.ts.list)){
  plot(part5.ts.list[[i]])
}</code></pre>
<p>Imagine you are looking for variants of part5.pattern where the middle peak is particularly high. Try defining a ruleset that only matches patterns where the middle peak is twice as high as the first peak. You may find it useful to define peak height based on the endpoints of the pattern, for example: <code>height.baseline &lt;- mean(pips[[1]], pips[[7]])</code>.</p>
<p>Once you have defined a rule, try testing it on different time series within the list. You may find it useful to test your rule before running it on the actual data. You may do so by making your own time series using the CreateCustomTimeSeries function and passing them to your ruleset function like so:</p>
<pre class="r"><code>short.middle.peak &lt;- CreateCustomTimeSeries(
  c(0, 10, 5, 14, 5, 10, 0),
  c(5,5,5,5,5,5)
)

tall.middle.peak &lt;- CreateCustomTimeSeries(
  c(0, 10, 5, 16, 5, 10, 0),
  c(5,5,5,5,5,5)
)

#This should return false
your.ruleset(short.middle.peak, short.middle.peak)

#This should return true
your.ruleset(tall.middle.peak, tall.middle.peak)</code></pre>
<p>Keep in mind that these time series were generated randomly, so the embeded pattern will likely not be the only match.</p>
<p>You may find the following function useful in plotting your results.</p>
<pre class="r"><code>plotMatches &lt;- function (results){
    for( i in 1:length(results)){
    for( j in 1:length(results[[i]])){
        if(length(results[[i]])!=0){
            plot(
                results[[i]][[j]],
                main = c(&quot;ts&quot;, i, &quot;match&quot;, j)
            )
        }
    }
    }
}</code></pre>
<p>This concludes the tutorial. If you are participating in the evaluation, you may move on to the questionnaire.</p>
<div class="well">
<strong>If you happen to have a data set that you could use TSPatternQuery with, I would be interested in hearing about your experience with it. Please email me at joshanthonymarsh (AT) gmail (DOT) com if you have any feedback after using TSPatternQuery on your own.</strong>
</div>
</div>
<div id="part-6-questionnaire" class="section level1">
<h1>Part 6: Questionnaire</h1>
<p>The command below will save everything you have typed during this session into a file called “evaluation.Rhistory”. It will then print the contents of that file to your console. Please copy and paste this command into the R console and run it. Then copy and paste the output into the Google form before. Once you have done this, please answer the rest of the questions on the form.</p>
<pre class="r"><code>savehistory(&quot;evaluation.Rhistory&quot;)  
scan(&#39;evaluation.Rhistory&#39;,&#39;character&#39;, sep = &quot;\n&quot;). </code></pre>
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSc6R3QE-VxXMoOSCndWvoCyafKLzUmVhjBLotdtMBGmKrqefg/viewform?embedded=true" width="100%" height="800" frameborder="0" marginheight="0" marginwidth="0">
Loading…
</iframe>
</div>
<div id="part-7-debriefing" class="section level1">
<h1>Part 7: Debriefing</h1>
<p>Insert filled in text from debrief-script-template here</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
