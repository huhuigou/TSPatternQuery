---
title: "A Time Series Pattern Query Tool Using PIPs and Hybrid Template-Ruleset Matching"
author: "Joshua Anthony Marsh"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{A Time Series Pattern Query Tool Using PIPs and Hybrid Template-Ruleset Matching}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

##Introduction
This vignette will discuss the algorithm underlying the Time Series Pattern Query Tool (henceforth referred to as the "TSQuery Tool" for short) as well as certain tips and tricks for making queries run faster and more accurately. The TSQuery Tool is meant for quick exploration of time series data patterns, and is designed to be usable by individuals of varying skill sets. This package can be viewed as an implementation of the real time hybrid pattern matching scheme by Zhang et al.^[Zhe Zhang, Jian Jiang, Xiaoyan Liu, Ricky Lau, Huaiqing Wang, and Rui Zhang. A real time hybrid pattern matching scheme for stock time series. In Proceedings of the Twenty-First Australasian Conference on Database Technologies - Volume 104, ADC ’10, pages 161–170, Darlinghurst, Australia, Australia, 2010. Australian Computer Society, Inc.
] 

##The Interface
The TSQuery Tool may be accessed through the following function

```{r, fig.show='hold', eval=FALSE}
Query <- function(timeseries,
                  pattern.template,
                  ruleset,
                  distinctive.feature,
                  window.length = 1.2*GetTimeLength(pattern.template),
                  spearmans.rho.threshold = 0.7,
                  return.matched.patterns = FALSE
                  )
```
**Parameters:**
```{r, fig.show='hold', eval=FALSE}
timeseries
```
*timeseries* is the data being queried (i.e. the time series that may or may not contain patterns being searched for). It should be an xts time series object. *timeseries* can be of any length, and may be regular or irregular (time intervals betwen points do not have to be of the same length).
```{r, fig.show='hold', eval=FALSE}
pattern.template
```
The *pattern.template* is an xts time series that serves as the ideal representation of the pattern being searched for. The TSQuery Tool algoirhtm does not read times as absolute values. It only considers the time intervals (in seconds) between points. Thus, creating a *pattern.template* with times/dates that are far removed from the timeseries data is perfectly acceptable. In other words, a *pattern.template* with timestamps from 2016 will still match data from 1990, so long as the shape is sufficiently similar.
```{r, fig.show='hold', eval=FALSE}
ruleset
```

```{r, fig.show='hold', eval=FALSE}
distinctive.feature
```

```{r, fig.show='hold', eval=FALSE}
window.length = 1.2*GetTimeLength(pattern.template)
```

```{r, fig.show='hold', eval=FALSE}
spearmans.rho.threshold = 0.7
```

```{r, fig.show='hold', eval=FALSE}
return.matched.patterns = FALSE
```


##Algorithm
TSQuery Tool applies a sliding window to the 








#The Vignette template (TODO: delete once finished)

Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style

## Vignette Info

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
